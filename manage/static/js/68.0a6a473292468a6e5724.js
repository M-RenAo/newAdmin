webpackJsonp([68],{1063:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("el-row",{staticStyle:{"margin-top":"20px"}},[a("el-col",{attrs:{span:14,offset:4}},[a("el-form",{ref:"editdata",staticClass:"form food_form",attrs:{model:t.editdata,"label-width":"110px",rules:t.rules}},[a("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[a("el-input",{model:{value:t.editdata.title,callback:function(e){t.$set(t.editdata,"title",e)},expression:"editdata.title"}})],1),t._v(" "),a("el-form-item",{staticClass:"icon-el",attrs:{label:"配图"}},[a("div",{staticClass:"updatas"},[a("div",{staticClass:"icon-plus-container"}),t._v(" "),""!==t.editdata.image&&void 0!==t.editdata.image?a("div",{staticClass:"img-wrap"},[""!==t.editdata.image&&void 0!==t.editdata.image?a("img",{staticStyle:{width:"146px",height:"146px"},attrs:{src:"https://imapp-image.oss-cn-hangzhou.aliyuncs.com/"+t.editdata.image}}):t._e()]):t._e(),t._v(" "),""===t.editdata.image?a("el-button",{staticClass:"btnone",attrs:{type:"primary"}},[a("span",[t._v("上传")]),t._v(" "),a("input",{staticClass:"upload",staticStyle:{opacity:"0",width:"70px",height:"40px","z-index":"222",position:"absolute",top:"0px",left:"0px"},attrs:{type:"file"},on:{change:t.mapping}})]):t._e(),t._v(" "),""!==t.editdata.image?a("el-button",{staticClass:"btnone",attrs:{type:"primary"},on:{click:function(e){t.editdata.image=""}}},[t._v("删除")]):t._e()],1)]),t._v(" "),a("el-form-item",{attrs:{label:"快讯内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.editdata.content,callback:function(e){t.$set(t.editdata,"content",e)},expression:"editdata.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"文章来源",prop:"source"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:t.editdata.source,callback:function(e){t.$set(t.editdata,"source",e)},expression:"editdata.source"}}),t._v(" "),a("span",{staticStyle:{"font-size":"12px",color:"#666"}},[t._v("如果没有默认imApp")])],1),t._v(" "),a("el-form-item",{attrs:{label:"热讯推荐",prop:"recommend"}},[a("div",{staticClass:"radio"},[a("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("是")]),a("el-radio",{attrs:{label:"0"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("否")])],1),t._v(" "),a("div",{staticClass:"radio"},[a("el-select",{attrs:{disabled:1!=t.radio},on:{change:t.selectdate},model:{value:t.selectvalue,callback:function(e){t.selectvalue=e},expression:"selectvalue"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("span",{staticStyle:{"font-size":"12px",color:"#666"}},[t._v("热讯只有发布状态下生效")])]),t._v(" "),a("div",{staticClass:"line"}),t._v(" "),a("el-form-item",[a("div",{staticClass:"left"},[t._v("\n                            字数"+t._s(t.editdata.content.length)+"字\n                    ")]),t._v(" "),a("div",{staticClass:"release"},[a("div",{staticClass:"right"},[a("el-button",{on:{click:function(e){t.submit(t.editdata)}}},[t._v("发布")]),t._v(" "),a("el-button",{on:{click:function(e){t.draft(t.editdata)}}},[t._v("存草稿")])],1)])])],1)],1)],1)],1)},staticRenderFns:[]}},272:function(t,e,a){a(944);var i=a(58)(a(722),a(1063),null,null);t.exports=i.exports},722:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(110),o=a.n(i),n=a(109),s=a.n(n);e.default={data:function(){return{uploadImageUrl:"",editdata:{title:"",image:"",content:"",source:"imApp",hot:!0,expire:86400,draft:!1},selectvalue:"当天",options:[{value:"1",label:"当天"},{value:"2",label:"三天"},{value:"3",label:"无限制"}],radio:"1",rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],content:[{required:!0,message:"请输入快讯内容",trigger:"blur"}]},imgData:{accept:"image/gif, image/jpeg, image/png, image/jpg,image/webp"},switch:!1}},created:function(){var t=this;this.switch=!1,this.$route.query.dataId&&this.$ajax.get(BaseUrl+"newsFlash/getArticle/"+this.$route.query.dataId,{headers:{token:sessionStorage.getItem("token")}}).then(function(e){t.editdata=e.data.data,t.switch=!0,t.editdata.expire=Math.round(new Date/1e3)+86400,t.expire=Math.round(new Date/1e3)+86400,t.editdata.hot=!0}),this.expire=Math.round(new Date/1e3)+86400},computed:{},methods:{mapping:function(t){var e=this,a=null;this.$ajax.get(BaseUrl+"alioss/getpolicy",{params:{fileName:t.target.files[0].name,type:"image",callBackType:"app_image"},headers:{token:sessionStorage.getItem("token")}}).then(function(i){if(200==i.data.flag)a=i.data.data,e.UploadUrl=i.data.data.host;else{if(201!=i.data.flag)return void alert("权限获取失败！");e.$alert(i.data.msg+"，请重新登录","提示",{confirmButtonText:"确定",callback:function(t){e.$router.push("/")}})}var o=t.target.files[0],n=o.type;o.size;if(-1==e.imgData.accept.indexOf(n))return alert("请选择我们支持的图片格式！"),!1;var s=new FormData;s.append("key",a.key),s.append("OSSAccessKeyId",a.OSSAccessKeyId),s.append("expire",a.expire),s.append("policy",a.policy),s.append("Signature",a.Signature),s.append("callback",a.callback),s.append("file",o),s.append("x:user",sessionStorage.getItem("userName")),s.append("x:filename",a.fileName),s.append("x:type",a.type),e.$ajax({method:"POST",url:e.UploadUrl,data:s}).then(function(t){e.editdata.image=t.data.data})})},selectdate:function(t){this.editdata.expire=1==t?Math.round(new Date/1e3)+86400:2==t?Math.round(new Date/1e3)+259200:Math.round(new Date/1e3)+31536e3},submit:function(t){this.editdata.draft=!1,this.editdata.expire=this.expire,this.prooFreading()},draft:function(t){this.editdata.draft=!0,this.prooFreading()},createEdit:function(){var t=this;this.$ajax({method:"POST",url:BaseUrl+"newsFlash/create",data:this.editdata,headers:{token:sessionStorage.getItem("token")}}).then(function(e){t.$router.push({path:"/messageManagement"}),console.log(e),console.log(t.editdata)})},editEdit:function(){var t=this;this.$ajax({method:"POST",url:BaseUrl+"newsFlash/update",data:this.editdata,headers:{token:sessionStorage.getItem("token")}}).then(function(e){t.$router.push({path:"/messageManagement"})})},prooFreading:function(){var t=this;this.$refs.editdata.validate(function(){var e=s()(o.a.mark(function e(a){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=5;break}console.log(t.editdata),t.switch?(t.editEdit(),console.log(1)):(t.createEdit(),console.log(2)),e.next=7;break;case 5:return t.$alert("请填写完整",{confirmButtonText:"确定",callback:function(e){t.$message({type:"info",message:"请重试！"})}}),e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}())}},watch:{radio:function(t,e){this.editdata.hot=1==t}}}},839:function(t,e,a){e=t.exports=a(241)(!1),e.push([t.i,'.allcover{position:absolute;top:0;right:0}.ctt{left:50%;transform:translate(-50%,-50%)}.ctt,.tb{position:absolute;top:50%}.tb{transform:translateY(-50%)}.lr{position:absolute;left:50%;transform:translateX(-50%)}a,article,aside,b,body,button,dd,div,dl,dt,figcaption,figure,footer,h1,h2,h3,h4,h5,h6,header,i,input,li,nav,p,section,select,span,textarea,ul{padding:0;margin:0;list-style:none;font-style:normal;text-decoration:none;border:none;font-family:Microsoft Yahei,sans-serif;-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:antialiased}a:focus,article:focus,aside:focus,b:focus,body:focus,button:focus,dd:focus,div:focus,dl:focus,dt:focus,figcaption:focus,figure:focus,footer:focus,h1:focus,h2:focus,h3:focus,h4:focus,h5:focus,h6:focus,header:focus,i:focus,input:focus,li:focus,nav:focus,p:focus,section:focus,select:focus,span:focus,textarea:focus,ul:focus{outline:none}::-webkit-scrollbar{width:0;height:0;background-color:#f5f5f5}::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 1px transparent;border-radius:10px;background-color:#f5f5f5}::-webkit-scrollbar-thumb{border-radius:10px;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.3);background-color:#555}input[type=button],input[type=reset],input[type=search],input[type=submit],textarea{-webkit-appearance:none}.fillcontain,body,html{height:100%;width:100%}.clear:after{content:"";display:block;clear:both}.clear{zoom:1}.back_img{background-repeat:no-repeat;background-size:100% 100%}.margin{margin:0 auto}.left{float:left}.right{float:right}.hide{display:none}.show{display:block}.ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.content .form{min-width:400px;margin-bottom:30px}.content .form:hover{box-shadow:0 0 8px 0 rgba(232,237,250,.6),0 2px 4px 0 rgba(232,237,250,.5);border-radius:6px;transition:all .4s}.content .img-wrap{width:148px;height:148px}.content .icon-el{height:147px;position:relative}.content .icon-el .el-form-item__content{display:flex;position:absolute}.content .icon-el div.el-form-item__content{border:0!important}.content .icon-el div{background-color:#fbfdff;border:1px dashed #c0ccda;border-radius:6px;box-sizing:border-box;width:148px;height:148px;cursor:pointer;line-height:146px;vertical-align:top;position:absolute}.content .radio{display:inline-block;padding:0 10px}.content .line{margin-top:100px;width:100%;border-top:1px solid #000}.content .release{overflow:hidden;margin-top:10px;padding:10px 0 20px;width:100%}.content .release div{line-height:40px}.content .release .right{margin-right:10px}.content .left{margin-left:-90px}.content .updatas{position:relative}.content .btnone{position:absolute;left:170px;top:105px;width:70px;height:40px}',""])},944:function(t,e,a){var i=a(839);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(242)("3947aceb",i,!0)}});
webpackJsonp([41],{311:function(t,e,a){a(871);var o=a(58)(a(761),a(990),"data-v-000625a0",null);t.exports=o.exports},315:function(t,e,a){"use strict";a.d(e,"b",function(){return o}),a.d(e,"a",function(){return r});var o="",r=void 0;o="//elm.cangdu.org",r="//elm.cangdu.org/img/"},439:function(t,e,a){a(442);var o=a(58)(a(440),a(443),"data-v-771ef16e",null);t.exports=o.exports},440:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(110),r=a.n(o),s=a(109),n=a.n(s),i=a(59),l=a.n(i),p=a(108),d=(a.n(p),a(315)),u=a(111);e.default={data:function(){return{baseImgPath:d.a}},created:function(){},computed:l()({},a.i(u.b)(["adminInfo"])),methods:{handleCommand:function(t){var e=this;return n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:"home"==t?e.$router.push("/manage"):"singout"==t&&(sessionStorage.removeItem("token"),e.$router.push("/"));case 1:case"end":return a.stop()}},a,e)}))()}}}},441:function(t,e,a){e=t.exports=a(241)(!1),e.push([t.i,".allcover[data-v-771ef16e]{position:absolute;top:0;right:0}.ctt[data-v-771ef16e]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.tb[data-v-771ef16e]{position:absolute;top:50%;transform:translateY(-50%)}.lr[data-v-771ef16e]{position:absolute;left:50%;transform:translateX(-50%)}.header_container[data-v-771ef16e]{background-color:#eff2f7;height:60px;display:flex;justify-content:space-between;align-items:center;width:100%}.avator[data-v-771ef16e]{width:36px;height:36px;border-radius:50%;margin-right:37px}.el-dropdown-menu__item[data-v-771ef16e]{text-align:center}",""])},442:function(t,e,a){var o=a(441);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a(242)("31846a3f",o,!0)},443:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header_container"},[a("el-breadcrumb",{staticStyle:{"padding-left":"20px"},attrs:{separator:"/"}},t._l(t.$route.meta,function(e,o){return a("el-breadcrumb-item",{key:o},[t._v(t._s(e))])})),t._v(" "),a("el-dropdown",{attrs:{"menu-align":"start"},on:{command:t.handleCommand}},[a("img",{staticClass:"avator",attrs:{src:t.baseImgPath+t.adminInfo.avatar}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"home"}},[t._v("首页")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"singout"}},[t._v("退出")])],1)],1)],1)},staticRenderFns:[]}},761:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(116),r=a.n(o),s=a(439),n=a.n(s);a(315);e.default={data:function(){return{fileName:"",uploadPolicy:"",UploadUrl:"",file:"",showProgress:!1,progressStepsActive:0,showProgressSteps:!0,filetype:""}},components:{headTop:n.a},created:function(){"android"==this.$route.query.type?this.filetype="apk":"ios"==this.$route.query.type&&(this.filetype="ipa")},computed:{},methods:{add_app:function(t){var e=this;this.file=t.target.files[0],this.$ajax.get(BaseUrl+"alioss/getpolicy",{params:{fileName:t.target.files[0].name,type:"apply",callBackType:"app_update"},headers:{token:sessionStorage.getItem("token"),device:this.$route.query.type}}).then(function(a){if(200==a.data.flag)e.uploadPolicy=a.data.data,e.UploadUrl=a.data.data.host;else{if(201!=a.data.flag)return void alert("权限获取失败！");e.$alert(a.data.msg+"，请重新登录","提示",{confirmButtonText:"确定",callback:function(t){e.$router.push("/")}})}e.fileName=t.target.files[0].name})},submitUpload:function(){var t=this,e=this,a=new r.a(function(t,a){var o=new FormData,r=e.file;r.type,r.size;o.append("key",e.uploadPolicy.key),o.append("OSSAccessKeyId",e.uploadPolicy.OSSAccessKeyId),o.append("expire",e.uploadPolicy.expire),o.append("policy",e.uploadPolicy.policy),o.append("Signature",e.uploadPolicy.Signature),o.append("Content-Disposition",e.uploadPolicy["Content-Disposition"]),o.append("callback",e.uploadPolicy.callback),o.append("file",r),o.append("x:appid",e.$route.query.id),o.append("x:user",sessionStorage.getItem("userName")),o.append("x:filename",e.uploadPolicy.fileName),o.append("x:type",e.uploadPolicy.type),e.$ajax({method:"POST",url:e.UploadUrl,data:o,onUploadProgress:function(t){t.lengthComputable&&(e.progressStepsActive=1)}}).then(function(o){500==o.data.flag?(e.$alert(o.data.msg,"提示",{confirmButtonText:"确定",callback:function(t){e.$message({type:"info",message:"error: "+o.data.msg})}}),a(error)):200==o.data.flag?(e.progressStepsActive=2,t(o.data.flag)):201==o.data.flag&&e.$alert(o.data.msg+"，请重新登录","提示",{confirmButtonText:"确定",callback:function(t){e.$router.push("/")}})})}),o=new r.a(function(t,a){var o=e.file,r=new FormData;r.append("key",e.uploadPolicy.key),r.append("file",o),e.$ajax({method:"POST",url:BaseUrl+"apply/appUpload",data:r,headers:{token:sessionStorage.getItem("token"),device:e.$route.query.type}}).then(function(o){500==o.data.flag?(e.$alert(o.data.msg,"提示",{confirmButtonText:"确定",callback:function(t){e.$message({type:"info",message:"error: "+o.data.msg})}}),a(error)):200==o.data.flag?t(o.data.flag):201==o.data.flag&&e.$alert(o.data.msg+"，请重新登录","提示",{confirmButtonText:"确定",callback:function(t){e.$router.push("/")}})})});r.a.all([a,o]).then(function(e){t.progressStepsActive=3;var a=t;t.$ajax.get(BaseUrl+"apply/auto/update/"+t.$route.query.id,{headers:{token:sessionStorage.getItem("token"),device:t.$route.query.type}}).then(function(t){200==t.data.flag?(a.progressStepsActive=4,a.$alert(t.data.msg,"提示",{confirmButtonText:"确定",callback:function(t){"android"==a.$route.query.type?a.$router.push({path:"/applicationList",query:{page:a.$route.query.page,size:a.$route.query.size,flag:a.$route.query.flag,tagcode:a.$route.query.tagcode}}):"ios"==a.$route.query.type&&a.$router.push({path:"/iosList",query:{page:a.$route.query.page,size:a.$route.query.size,flag:a.$route.query.flag,tagcode:a.$route.query.tagcode}})}})):201==t.data.flag?a.$alert(t.data.msg+"，请重新登录","提示",{confirmButtonText:"确定",callback:function(t){a.$router.push("/")}}):a.$alert(t.data.msg,"提示",{confirmButtonText:"确定"})})}).catch(function(t){})}}}},766:function(t,e,a){e=t.exports=a(241)(!1),e.push([t.i,".allcover[data-v-000625a0]{position:absolute;top:0;right:0}.ctt[data-v-000625a0]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.tb[data-v-000625a0]{position:absolute;top:50%;transform:translateY(-50%)}.lr[data-v-000625a0]{position:absolute;left:50%;transform:translateX(-50%)}.progress-wrap[data-v-000625a0]{display:flex;align-items:center;justify-content:center;margin:1rem;height:5rem}.steps-style[data-v-000625a0]{padding-left:150px}",""])},871:function(t,e,a){var o=a(766);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a(242)("03e7583d",o,!0)},990:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticStyle:{"margin-top":"300px",display:"flex","justify-content":"center"}},[a("div",[a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"el-button el-button--primary el-button--small",staticStyle:{height:"28px"}},[a("div",{staticStyle:{position:"absolute"}},[t._v(" 选取文件")]),t._v(" "),"android"==t.$route.query.type?a("input",{staticStyle:{display:"block",opacity:"0",width:"50px"},attrs:{type:"file",accept:".apk"},on:{change:t.add_app}}):t._e(),t._v(" "),"ios"==t.$route.query.type?a("input",{staticStyle:{display:"block",opacity:"0",width:"50px"},attrs:{type:"file",accept:".ipa"},on:{change:t.add_app}}):t._e()]),t._v(" "),a("el-button",{ref:"upload",staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success",readonly:""},on:{click:t.submitUpload}},[t._v("上传到服务器")])],1),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传"+t._s(t.filetype)+"文件")]),t._v(" "),a("div",[t._v(t._s(t.fileName))])])]),t._v(" "),a("div",{staticClass:"progress-wrap"},[t.showProgressSteps?a("el-steps",{staticClass:"steps-style",attrs:{space:200,active:t.progressStepsActive,"finish-status":"success"}},[a("el-step",{attrs:{title:"正在上传"}}),t._v(" "),a("el-step",{attrs:{title:"上传完毕"}}),t._v(" "),a("el-step",{attrs:{title:"正在配置"}}),t._v(" "),a("el-step",{attrs:{title:"配置成功"}})],1):t._e()],1)],1)},staticRenderFns:[]}}});